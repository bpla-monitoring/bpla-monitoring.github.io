<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="index.css">
    <script type="text/javascript" src="jquery-3.5.1.min.js"></script>

    <script type="text/javascript" src="multirotors.js"></script>
    <script type="text/javascript" src="planes.js"></script>
    <script type="text/javascript" src="helicopters.js"></script>

    <script type="text/javascript" src="multirotorsp.js"></script>
    <script type="text/javascript" src="planesp.js"></script>
    <script type="text/javascript" src="helicoptersp.js"></script>

    <link rel="manifest" href="/manifest.json">
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js').then(function(registration) {
      // Registration was successful
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
      // registration failed :(
      console.log('ServiceWorker registration failed: ', err);
    });
  });
}
</script>

</head>

<body>
    <div id="main">
        <h1>Прогнозирование</h1>
        <br>

        <p align="center">
            <a href="index.html">Мониторинг</a> | Прогнозирование

        </p>
        <br>
        <p>
            Открыть карту (*.bmp,*.jpg,*.png, *.gif)
            <input class="open" type="file" id="Open" required="required" title="Необходимо выбрать минимум один файл"
                onchange="processFiles(this.files)">
        </p>

        <div id="maptxt"></div>

        <br>
        Масштаб карты: 1 см = <input type="text" id="mH" value="10" size="5"> м
        <button id="SetmH" onclick="SetmH()">Применить масштаб</button>
        <span id="size"></span>
        <br>
        <br>
        <hr>
        <br>
        Шаг сетки: <input type="text" id="gridstep" value="10" size="5"> м Цвет сетки: <input id="gridcolor"
            type="color" onchange="New()" value="#FF0000"> Прозрачность: <input id="gridtrans" type="number" value="50">
        % Толщина линии: <input id="gridwidth" type="number" value="1"> px Радиус точки: <input id="gridradius"
            type="number" value="5"> px<br><br>

        <button id="SetGrid" onclick="SetGrid()">Обновить/показать сетку</button>
        <button id="HideGrid" onclick="HideGrid()">Скрыть сетку</button>

        <br>
        <br>
        <hr>
        <br>

        С<sub>1</sub> = <input id="С1" type="text" value="0.32">
        С<sub>2</sub> = <input id="С2" type="text" value="0.05">
        С<sub>3</sub> = <input id="С3" type="text" value="0.17">
        С<sub>4</sub> = <input id="С4" type="text" value="0.11">
        С<sub>5</sub> = <input id="С5" type="text" value="0.03">
        С<sub>6</sub> = <input id="С6" type="text" value="0.21">
        С<sub>7</sub> = <input id="С7" type="text" value="0.11">
        Тип точки: <select id="point_type">
            <option value="0.32">С1</option>
            <option value="0.05">С2</option>
            <option value="0.17">С3</option>
            <option value="0.11">С4</option>
            <option value="0.03">С5</option>
            <option value="0.21">С6</option>
            <option value="0.11">С7</option>
        </select>
        <br>
        <br>
        <button id="GetPoint" onclick="GetPoint()">Принять точки</button><br><br>

        <hr>
        <br>

        Цвет маршрута: <input id="color" type="color" onchange="New()" value="#00FF00"> (измените цвет для нового
        маршрута) Прозрачность: <input id="trans" type="number" value="100"> % Толщина линии: <input id="linewidth"
            type="number" value="5"> px<br><br>

        <button onclick="Add()">Добавить маршрут</button><br><br><br>

        <div id="map">
            <div id="cnv">
                <canvas id="img_canvas"></canvas>
                <canvas id="grid_canvas"></canvas>
                <canvas id="point_canvas"></canvas>
                <canvas id="marsh_canvas"></canvas>
            </div>
        </div>
        <br>
        <br>
        <table>
            <tr>
                <td>
                    <table id="marshd">
                    </table>
                </td>
                <td>
                    <table id="dist">
                    </table>
                </td>
            </tr>
        </table>



        <br>

        <button onclick="Res()">Рассчитать</button>
        <br>
        <div id="main2">
            <br>
            Таблица вероятностей:

            <br>
            <br>
            <table id="res" class="marsh">

            </table>
            <br>
            Нормировка:
            <br>
            <br>

            <table id="norm" class="marsh">

            </table>


            <br>
            <canvas id="plot"></canvas>
            <br>
            Модификация:
            <br>
            <br>
            ϴ = <input id="tetta" type="text" value="0.5">
            <br>
            <br>
            <table id="mod" class="marsh">

            </table>
            <br>

            <button onclick="Plot1()">Обновить график</button>
            <br>
            <br>
            <br>
            <canvas id="plot1"></canvas>
            <br>
            Выберите маршрут: <select id="nmarsh">
            </select>
            <br>
            <!-- <br>
            <table id="vmarsh" class="marsh"></table>
            <br> -->
            <br>
            Тип БПЛА: <select id="type">
                <option value="Мультиротор">Мультиротор</option>
                <option value="Самолет">Самолет</option>
                <option value="Вертолет">Вертолет</option>

            </select>
            <br>
            <br>
            Выбор модели БПЛА: <select id="bpla"></select>
            <br>
            <br>
            <table id="ver" class="marsh"></table><br>
            Масса полезной нагрузки, кг: <span id="bplam"></span><br><br>
            Время работы БПЛА, ч: <span id="bplat"></span><br><br>
            Максисмальная высота БПЛА, м: <span id="bplah"></span><br><br>
            Радиус действия радиоканала, км: <span id="bplar"></span><br><br>
            Время оперативного реагирования, мин: <span id="bplatr"></span><br>
            <br>
            T<sub>1</sub> = <input id="t1" type="text" value="10">
            T<sub>2</sub> = <input id="t2" type="text" value="20">
            T<sub>3</sub> = <input id="t3" type="text" value="30">
            T<sub>4</sub> = <input id="t4" type="text" value="40">
            <br>
            <br>
            <button onclick="E()">Рассчитать</button>
            <br>
            <br>
            Количество БПЛА = <span id="nbpla"></span>
        </div>
        <br>
        <br>
        <br>
        <br>


        <script>
            $("#point_type").change(function () {


            });

            function R1() {
                var pmin = $('#pmin').val();
                var pust = $('#pust').val();
                var vb = $('#vb').val();
                var q = $('#q').val();
                var ks = $('#ks').val();
                var tv = $('#tv').val();

                var to = ((pmin - pust) * vb) / (q * ks);
                to = Math.floor(to);
                $('#to').text('Т общ. = ' + to + ' мин.');


                console.log(tv);
                var date = new Date(new Date().toDateString() + " " + tv);

                var datah = date.getHours();
                var datam = date.getMinutes();

                // var date1 = new Date(new Date().toDateString() + " " + to);

                // var datah1 = date1.getHours();
                // var datam1 = date1.getMinutes();

                // console.log(to.toDateString());

                // // var tvo = h+h1+':'+m+m1;

                // $('#tvo').text('Т возвр. = ' + tvo);

            }


            var img; //изображение
            var img_canvas, grid_canvas, point_canvas, marsh_canvas; //канва
            var img_context, grid_context, point_context, marsh_context; //контексты 
            var width, height; //размеры изображения в пикселах
            var widthcm, heightcm; //размеры изображения в сантиметрах
            var mH; //масштаб
            var pointx = []; //координаты сетки
            var pointy = [];
            var coordx = []; //Координаты точки при клике
            var coordy = [];
            var pointt = [];
            var pointtt = [];
            var vcount, hcount; //количество шагов сетки
            var gp = false;
            var mx = []; //координаты точек маршрута
            var my = [];
            var number = []; //номер точки маршрута
            var tempX;
            var tempY;
            var temppointt = [];
            var temppointtt = [];
            var lpointt = [];
            var k = 0; // количество узлов сетки общее
            var m = 0; // количество точек
            var t = 0; // количество узлов одного маршрута
            var mcolor;
            var dist = []; // массив дистанций
            var summa = [];
            var colors = [];
            var sumpointm = [];
            var sumpoint = 0;
            var r = 1; // количество маршрутов
            var nr = 0;

            window.addEventListener('DOMContentLoaded', function () {
                OpenFile();
                var c = '';
                c = c + '<tr>';
                c = c + '<td>Наименование</td>';
                c = c + '<td>Ожидаемое время работы</td>';
                c = c + '<td>Среднее время работы</td>';
                c = c + '<td>P=0.25</td>';
                c = c + '<td>P=0.5</td>';
                c = c + '<td>P=0.75</td>';
                c = c + '<td>P=0.99</td>';
                c = c + '</tr>';
                c = c + '<tr>';
                c = c + '<td>' + multirotorsp[0].name + '</td>';
                c = c + '<td>' + multirotorsp[0].to + '</td>';
                c = c + '<td>' + multirotorsp[0].ts + '</td>';
                c = c + '<td>' + multirotorsp[0].P1 + '</td>';
                c = c + '<td>' + multirotorsp[0].P2 + '</td>';
                c = c + '<td>' + multirotorsp[0].P3 + '</td>';
                c = c + '<td>' + multirotorsp[0].P4 + '</td>';

                c = c + '</tr>';
                document.getElementById('ver').innerHTML = c;

                var b = '';
                for (name in multirotors) {
                    console.log(multirotors[name].name);
                    b = b + '<option value="' + multirotors[name].name + '">' + multirotors[name].name +
                        '</option>';
                }
                document.getElementById('bpla').innerHTML = b;
                $("#bplam").text(multirotors[0].m);
                $("#bplat").text(multirotors[0].tmax);
                $("#bplah").text(multirotors[0].h);
                $("#bplar").text(multirotors[0].r);
                $("#bplatr").text(multirotors[0].tr);
            });

            $('#marsh_canvas').click(function (e) {
                if (gp === false) {
                    SetPoint(e);
                } else {
                    SetLine(e);
                }
            });

            function processFiles(files) {



                var file = files[0];
                var reader = new FileReader();
                reader.onload = function (e) {

                    img = new Image();
                    img_canvas = document.getElementById("img_canvas");
                    img_context = img_canvas.getContext("2d");

                    grid_canvas = document.getElementById("grid_canvas");
                    grid_context = grid_canvas.getContext("2d");

                    point_canvas = document.getElementById("point_canvas");
                    point_context = point_canvas.getContext("2d");

                    marsh_canvas = document.getElementById("marsh_canvas");
                    marsh_context = marsh_canvas.getContext("2d");

                    img.onload = function () {
                        img_canvas.width = img.width;
                        img_canvas.height = img.height;

                        grid_canvas.width = img.width;
                        grid_canvas.height = img.height;

                        point_canvas.width = img.width;
                        point_canvas.height = img.height;

                        marsh_canvas.width = img.width;
                        marsh_canvas.height = img.height;

                        img_context.drawImage(img, 0, 0);

                        width = img.width;
                        height = img.height;

                        GetSize(width, height);
                        SetmH();
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }

            function OpenFile() {
                img = new Image();

                img_canvas = document.getElementById("img_canvas");
                img_context = img_canvas.getContext("2d");

                grid_canvas = document.getElementById("grid_canvas");
                grid_context = grid_canvas.getContext("2d");

                point_canvas = document.getElementById("point_canvas");
                point_context = point_canvas.getContext("2d");

                marsh_canvas = document.getElementById("marsh_canvas");
                marsh_context = marsh_canvas.getContext("2d");

                img.onload = function () {
                    img_canvas.width = img.width;
                    img_canvas.height = img.height;

                    grid_canvas.width = img.width;
                    grid_canvas.height = img.height;

                    point_canvas.width = img.width;
                    point_canvas.height = img.height;

                    marsh_canvas.width = img.width;
                    marsh_canvas.height = img.height;

                    img_context.drawImage(img, 0, 0);
                    width = img.width;
                    height = img.height;
                    GetSize(width, height);
                    SetmH();
                };
                img.src = "map3.png";


            }

            function GetSize(width, height) {
                widthcm = Math.round(100 * width * 2.54 / 96) / 100;
                heightcm = Math.round(100 * height * 2.54 / 96) / 100;
                document.getElementById('maptxt').innerHTML = 'Размер изображения: ' + width + 'px x ' +
                    height +
                    'px<br><br>Реальный размер карты: ' + widthcm.toString() + 'cм x ' +
                    heightcm.toString() + 'см (при печати 96dpi)';
            }

            function SetmH() {
                mH = $('#mH').val();
                $('#size').text('Размеры: ' + (mH * widthcm).toFixed(2) + 'м x ' + (mH * heightcm).toFixed(2) +
                    'м');
            }

            function SetGrid() {
                k = 0;
                //m=0;
                coordx = [];
                coordy = [];
                //pointx = [];
                //pointy = [];


                grid_context.clearRect(0, 0, width, height);
                //point_context.clearRect(0, 0, width, height);

                var step = $('#gridstep').val();
                step = (step * 96 / 2.54) / 10;

                vcount = width / step;
                hcount = height / step;

                var color = $('#gridcolor').val();
                var r = parseInt(color.substring(1, 3), 16);
                var g = parseInt(color.substring(3, 5), 16);
                var b = parseInt(color.substring(5), 16);
                var gtrans = $('#gridtrans').val() / 100;


                color = 'rgba(' + r + ',' + g + ',' + b + ',' + gtrans + ')';
                var r = $('#gridradius').val();
                var w = $('#gridwidth').val();

                for (var i = 0; i <= vcount; i++) {
                    for (var j = 0; j <= hcount; j++) {
                        circle(i * step, j * step, color, r, w);
                        pointx[k] = i * step;
                        pointy[k] = j * step;
                        k++;
                    }
                }
            }

            function circle(x, y, color, r, w) {
                grid_context.beginPath();
                grid_context.arc(x, y, r, 0, 2 * Math.PI, false);
                grid_context.strokeStyle = color;
                grid_context.lineWidth = w;
                grid_context.stroke();
            }

            function SetPoint(e) {
                var linewidth = $('#linewidth').val();
                var color = $('#gridcolor').val();
                var trans = $('#gridtrans').val() / 100;
                var radius = $('#gridradius').val();
                var r = parseInt(color.substring(1, 3), 16);
                var g = parseInt(color.substring(3, 5), 16);
                var b = parseInt(color.substring(5), 16);
                color = 'rgba(' + r + ',' + g + ',' + b + ',' + trans + ')';
                var x = e.offsetX;
                var y = e.offsetY;

                for (var i = 0; i <= k - 1; i++) {
                    if ((x - pointx[i] <= Math.sqrt(radius * radius - (y - pointy[i]) * (
                            y - pointy[i]))) && (y - pointy[i] <= Math.sqrt(radius * radius -
                            (x - pointx[i]) * (x - pointx[i])))) {
                        circle2(pointx[i], pointy[i], radius, color);
                        coordx[m] = pointx[i];
                        coordy[m] = pointy[i];
                        pointt[m] = $('#point_type option:selected').val();
                        pointtt[m] = $('#point_type option:selected').text();
                        temppointt[m] = pointt[m];
                        temppointtt[m] = pointtt[m];


                        SetText(coordx[m], coordy[m]);
                        m++;
                    }

                }

            }

            function HideGrid() {
                grid_context.clearRect(0, 0, width, height);
            }

            function circle2(x, y, r, color) {
                point_context.beginPath();
                point_context.arc(x, y, r, 0, 2 * Math.PI, false);
                point_context.fillStyle = color;
                point_context.fill();
            }

            function SetText(x, y) {
                point_context.beginPath();
                point_context.strokeStyle = 'black';
                point_context.fillStyle = 'black';
                point_context.font = "15px Arial";
                var type = $('#point_type option:selected').text();
                point_context.fillText(type, x + 4, y - 4);
            }

            function GetPoint() {
                gp = true;

            }

            function SetLine(e) {
                var linewidth = $('#linewidth').val();
                mcolor = $('#color').val();
                var trans = $('#trans').val() / 100;
                var radius = $('#gridradius').val();
                console.log(mcolor);
                var r = parseInt(mcolor.substring(1, 3), 16);
                var g = parseInt(mcolor.substring(3, 5), 16);
                var b = parseInt(mcolor.substring(5), 16);
                console.log(r, g, b);
                mcolor = 'rgba(' + r + ',' + g + ',' + b + ',' + trans + ')';

                var x = e.offsetX;
                var y = e.offsetY;

                for (var i = 0; i <= m - 1; i++) {

                    if ((x - coordx[i] <= Math.sqrt(radius * radius - (y - coordy[i]) * (
                            y -
                            coordy[i]))) && (y - coordy[i] <= Math.sqrt(radius * radius -
                            (x -
                                coordx[i]) * (x - coordx[i])))) {
                        if ((tempX == undefined) && (tempX == undefined)) {
                            tempX = coordx[i];
                            tempY = coordy[i];
                            mx[t] = coordx[i];
                            my[t] = coordy[i];
                            number[t] = i;
                            pointt[t] = temppointt[i];
                            pointtt[t] = temppointtt[i];
                            t++;
                        } else {
                            marsh_context.beginPath();
                            marsh_context.strokeStyle = mcolor;
                            marsh_context.lineWidth = linewidth;
                            marsh_context.moveTo(tempX, tempY);
                            marsh_context.lineTo(coordx[i], coordy[i]);
                            marsh_context.stroke();
                            tempX = coordx[i];
                            tempY = coordy[i];
                            mx[t] = coordx[i];
                            my[t] = coordy[i];
                            number[t] = i;
                            pointt[t] = temppointt[i];
                            pointtt[t] = temppointtt[i];
                            t++;
                        }
                    }
                }
                //console.log(mx,my);
            }

            function New() {
                mx = [];
                my = [];
                number = [];
                pointt = [];
                pointtt = [];
                t = 0;

                tempX = undefined;
                tempY = undefined;
            }
            var l = 1;

            function Add() {

                dist = [];
                for (var i = 0; i <= t - 2; i++) {
                    dist[i] = Math.sqrt(Math.pow(mx[i + 1] - mx[i], 2) + Math.pow(my[i + 1] - my[i],
                        2));
                    dist[i] = (dist[i] * 10 * 2.54) / 96;

                }
                var row = $('<tr></tr>');
                row.append('<td>Маршрут ' + l + '</td>');
                //var a = '';
                var sum = 0;
                for (var i = 0; i <= t - 2; i++) {
                    //var a = a + '<td>' + i + '</td>';
                    dist[i] = Math.round(dist[i]);

                    var cell = $('<td>(' + pointtt[i] + ' - ' + pointtt[i + 1] + ') ' + dist[i] + '</td>');
                    sum = sum + dist[i];

                    row.append(cell);

                }
                var a = '';
                a = a + '<tr>';
                a = a + '<td style="background-color: ' + mcolor + '">';
                a = a + sum.toFixed(2);
                a = a + '</td>';
                a = a + '</tr>';
                summa[l - 1] = sum;
                colors[l] = mcolor;
                $('#dist').append(a);
                $('#marshd').append(row);
                lpointt[l] = pointt;


                w = w + '<option value="Маршрут' + l + '">Маршрут ' + l + '</option>';
                document.getElementById('nmarsh').innerHTML = w;

                l++;
            }
            var w = '';
            var plotx = [];
            var ploty = [];

            function Res() {
                document.getElementById('main2').style.display = 'block';
                // console.log('Результат');
                // console.log(l - 1);
                // console.log(dist);
                // console.log(pointt);
                //console.log(lpointt);
                // console.log(summa);
                var b = '';
                b = b + '<tr>';
                b = b + '<td>Маршрут</td><td>P</td><td>L(м)</td>';
                b = b + '</tr>';
                for (var i = 0; i <= l - 2; i++) {
                    b = b + '<tr>';
                    b = b + '<td style="background-color: ' + colors[i + 1] + '">M' + (i + 1) + '</td>';
                    for (var j = 1; j <= lpointt[i + 1].length - 2; j++) {
                        //b = b + '<td>' + lpointt[i+1][j] + '</td>';
                        sumpoint = sumpoint + parseFloat(lpointt[i + 1][j]);
                    }
                    b = b + '<td>' + sumpoint.toFixed(2) + '</td>';
                    sumpointm[i] = sumpoint;
                    sumpoint = 0;
                    b = b + '<td>' + summa[i] + '</td>';
                    b = b + '</tr>';
                }

                document.getElementById('res').innerHTML = b;

                var c = '';
                var cm = '';
                var tetta = document.getElementById('tetta').value;
                c = c + '<tr>';
                c = c + '<td>Маршрут</td><td>P<sub>норм</sub></td><td>L(м)</td>';
                c = c + '</tr>';
                for (var i = 0; i <= l - 2; i++) {
                    c = c + '<tr>';
                    c = c + '<td style="background-color: ' + colors[i + 1] + '">M' + (parseInt(i) + 1) + '</td>';
                    c = c + '<td>' + (sumpointm[i] / Math.max.apply(null, sumpointm)).toFixed(2) + '</td>';
                    plotx[i] = (sumpointm[i] / Math.max.apply(null, sumpointm)).toFixed(2);
                    c = c + '<td>' + (1 - summa[i] / Math.max.apply(null, summa)).toFixed(2) + '</td>';
                    ploty[i] = (1 - summa[i] / Math.max.apply(null, summa)).toFixed(2);
                    console.log('Макс.вероятность=', Math.max.apply(null, sumpointm).toFixed(2));
                    console.log('Макс.длина=', Math.max.apply(null, summa).toFixed(2));
                    c = c + '</tr>';


                }

                document.getElementById('norm').innerHTML = c;
                Plot();
                Plot1();

            }

            function Plot() {
                colors.shift();
                var xyValues = [];
                for (var i = 0; i <= l - 2; i++) {
                    xyValues.push({
                        x: parseFloat(plotx[i]),
                        y: parseFloat(ploty[i])
                    });
                }
                console.log(xyValues);
                console.log(colors);
                new Chart("plot", {
                    type: "scatter",
                    data: {
                        datasets: [{
                            pointRadius: 10,
                            pointBackgroundColor: colors,
                            data: xyValues
                        }]
                    },
                    options: {
                        hover: {
                            mode: null
                        },
                        animation: {
                            duration: 0, // general animation time
                        },
                        hover: {
                            animationDuration: 0, // duration of animations when hovering an item
                        },
                        responsiveAnimationDuration: 0, // animation duration after a resize

                        tooltips: {
                            enabled: false,
                        },
                        responsive: false, //Вписывать в размер canvas
                        legend: {
                            display: false
                        },
                        scales: {
                            xAxes: [{
                                display: true,
                                ticks: {
                                    min: -0.2,
                                    max: 1.2
                                }
                            }],
                            yAxes: [{
                                display: true,
                                ticks: {
                                    min: -0.2,
                                    max: 1.2
                                }
                            }],
                        },
                        title: {
                            display: true,
                            text: 'График 1'
                        }
                    }
                });

            }

            //---------------------Построение графика ----------------------------------
            function Plot1() {
                var cm = '';
                var tetta = document.getElementById('tetta').value;
                cm = cm + '<tr>';
                cm = cm + '<td>Маршрут</td><td>x</td><td>y</td>';
                cm = cm + '</tr>';
                for (var i = 0; i <= l - 2; i++) {
                    cm = cm + '<tr>';
                    cm = cm + '<td style="background-color: ' + colors[i] + '">M' + (parseInt(i) + 1) + '</td>';
                    cm = cm + '<td>' + plotx[i] + '</td>';
                    ploty[i] = tetta * plotx[i] + (1 - tetta) * ploty[i];
                    cm = cm + '<td>' + ploty[i].toFixed(2) + '</td>';
                    cm = cm + '</tr>';
                }
                document.getElementById('mod').innerHTML = cm;

                var xyValues = [];
                for (var i = 0; i <= l - 2; i++) {
                    xyValues.push({
                        x: parseFloat(plotx[i]),
                        y: parseFloat(ploty[i])
                    });
                }
                console.log(xyValues);
                console.log(colors);
                new Chart("plot1", {
                    type: "scatter",
                    data: {
                        datasets: [{
                            pointRadius: 10,
                            pointBackgroundColor: colors,
                            data: xyValues
                        }]
                    },
                    options: {
                        hover: {
                            mode: null
                        },
                        animation: {
                            duration: 0, // general animation time
                        },
                        hover: {
                            animationDuration: 0, // duration of animations when hovering an item
                        },
                        responsiveAnimationDuration: 0, // animation duration after a resize
                        tooltips: {
                            enabled: false,
                        },
                        responsive: false, //Вписывать в размер canvas
                        legend: {
                            display: false
                        },
                        scales: {
                            xAxes: [{
                                display: true,
                                ticks: {
                                    min: -0.2,
                                    max: 1.2
                                }
                            }],
                            yAxes: [{
                                display: true,
                                ticks: {
                                    min: -0.2,
                                    max: 1.2
                                }
                            }],
                        },
                        title: {
                            display: true,
                            text: 'График 2'
                        }
                    }
                });
            }
            //--------------------------------------------------------------------------
            $("#type").change(function () {

                if ($("#type").val() === 'Мультиротор') {
                    var b = '';
                    for (name in multirotors) {
                        console.log(multirotors[name].name);
                        b = b + '<option value="' + multirotors[name].name + '">' + multirotors[name].name +
                            '</option>';
                    }
                    document.getElementById('bpla').innerHTML = b;
                    $("#bplam").text(multirotors[this.selectedIndex].m);
                    $("#bplat").text(multirotors[this.selectedIndex].tmax);
                    $("#bplah").text(multirotors[this.selectedIndex].h);
                    $("#bplar").text(multirotors[this.selectedIndex].r);
                    $("#bplatr").text(multirotors[this.selectedIndex].tr);
                    var c = '';
                    c = c + '<tr>';
                    c = c + '<td>Наименование</td>';
                    c = c + '<td>Ожидаемое время работы</td>';
                    c = c + '<td>Среднее время работы</td>';
                    c = c + '<td>P=0.25</td>';
                    c = c + '<td>P=0.5</td>';
                    c = c + '<td>P=0.75</td>';
                    c = c + '<td>P=0.99</td>';
                    c = c + '</tr>';
                    c = c + '<tr>';
                    c = c + '<td>' + multirotorsp[0].name + '</td>';
                    c = c + '<td>' + multirotorsp[0].to + '</td>';
                    c = c + '<td>' + multirotorsp[0].ts + '</td>';
                    c = c + '<td>' + multirotorsp[0].P1 + '</td>';
                    c = c + '<td>' + multirotorsp[0].P2 + '</td>';
                    c = c + '<td>' + multirotorsp[0].P3 + '</td>';
                    c = c + '<td>' + multirotorsp[0].P4 + '</td>';

                    c = c + '</tr>';
                    document.getElementById('ver').innerHTML = c;
                }
                if ($("#type").val() === 'Самолет') {
                    var b = '';
                    for (name in planes) {
                        console.log(planes[name].name);
                        b = b + '<option value="' + planes[name].name + '">' + planes[name].name + '</option>';
                    }
                    document.getElementById('bpla').innerHTML = b;
                    $("#bplam").text(planes[this.selectedIndex].m);
                    $("#bplat").text(planes[this.selectedIndex].tmax);
                    $("#bplah").text(planes[this.selectedIndex].h);
                    $("#bplar").text(planes[this.selectedIndex].r);
                    $("#bplatr").text(planes[this.selectedIndex].tr);
                    var c = '';
                    c = c + '<tr>';
                    c = c + '<td>Наименование</td>';
                    c = c + '<td>Ожидаемое время работы</td>';
                    c = c + '<td>Среднее время работы</td>';
                    c = c + '<td>P=0.25</td>';
                    c = c + '<td>P=0.5</td>';
                    c = c + '<td>P=0.75</td>';
                    c = c + '<td>P=0.99</td>';
                    c = c + '</tr>';
                    c = c + '<tr>';
                    c = c + '<td>' + planesp[0].name + '</td>';
                    c = c + '<td>' + planesp[0].to + '</td>';
                    c = c + '<td>' + planesp[0].ts + '</td>';
                    c = c + '<td>' + planesp[0].P1 + '</td>';
                    c = c + '<td>' + planesp[0].P2 + '</td>';
                    c = c + '<td>' + planesp[0].P3 + '</td>';
                    c = c + '<td>' + planesp[0].P4 + '</td>';

                    c = c + '</tr>';
                    document.getElementById('ver').innerHTML = c;
                }

                if ($("#type").val() === 'Вертолет') {
                    var b = '';
                    for (name in helicopters) {
                        console.log(helicopters[name].name);
                        b = b + '<option value="' + helicopters[name].name + '">' + helicopters[name].name +
                            '</option>';
                    }
                    document.getElementById('bpla').innerHTML = b;
                    $("#bplam").text(helicopters[this.selectedIndex].m);
                    $("#bplat").text(helicopters[this.selectedIndex].tmax);
                    $("#bplah").text(helicopters[this.selectedIndex].h);
                    $("#bplar").text(helicopters[this.selectedIndex].r);
                    $("#bplatr").text(helicopters[this.selectedIndex].tr);
                    var c = '';
                    c = c + '<tr>';
                    c = c + '<td>Наименование</td>';
                    c = c + '<td>Ожидаемое время работы</td>';
                    c = c + '<td>Среднее время работы</td>';
                    c = c + '<td>P=0.25</td>';
                    c = c + '<td>P=0.5</td>';
                    c = c + '<td>P=0.75</td>';
                    c = c + '<td>P=0.99</td>';
                    c = c + '</tr>';
                    c = c + '<tr>';
                    c = c + '<td>' + helicoptersp[0].name + '</td>';
                    c = c + '<td>' + helicoptersp[0].to + '</td>';
                    c = c + '<td>' + helicoptersp[0].ts + '</td>';
                    c = c + '<td>' + helicoptersp[0].P1 + '</td>';
                    c = c + '<td>' + helicoptersp[0].P2 + '</td>';
                    c = c + '<td>' + helicoptersp[0].P3 + '</td>';
                    c = c + '<td>' + helicoptersp[0].P4 + '</td>';

                    c = c + '</tr>';
                    document.getElementById('ver').innerHTML = c;
                }
            });

            $("#bpla").change(function () {

                if ($("#type").val() === 'Мультиротор') {
                    console.log(this.selectedIndex);
                    $("#bplam").text(multirotors[this.selectedIndex].m);
                    $("#bplat").text(multirotors[this.selectedIndex].tmax);
                    $("#bplah").text(multirotors[this.selectedIndex].h);
                    $("#bplar").text(multirotors[this.selectedIndex].r);
                    $("#bplatr").text(multirotors[this.selectedIndex].tr);


                    var c = '';
                    c = c + '<tr>';
                    c = c + '<td>Наименование</td>';
                    c = c + '<td>Ожидаемое время работы</td>';
                    c = c + '<td>Среднее время работы</td>';
                    c = c + '<td>P=0.25</td>';
                    c = c + '<td>P=0.5</td>';
                    c = c + '<td>P=0.75</td>';
                    c = c + '<td>P=0.99</td>';
                    c = c + '</tr>';
                    c = c + '<tr>';
                    c = c + '<td>' + multirotorsp[this.selectedIndex].name + '</td>';
                    c = c + '<td>' + multirotorsp[this.selectedIndex].to + '</td>';
                    c = c + '<td>' + multirotorsp[this.selectedIndex].ts + '</td>';
                    c = c + '<td>' + multirotorsp[this.selectedIndex].P1 + '</td>';
                    c = c + '<td>' + multirotorsp[this.selectedIndex].P2 + '</td>';
                    c = c + '<td>' + multirotorsp[this.selectedIndex].P3 + '</td>';
                    c = c + '<td>' + multirotorsp[this.selectedIndex].P4 + '</td>';

                    c = c + '</tr>';
                    document.getElementById('ver').innerHTML = c;
                }

                if ($("#type").val() === 'Самолет') {
                    console.log(this.selectedIndex);
                    $("#bplam").text(planes[this.selectedIndex].m);
                    $("#bplat").text(planes[this.selectedIndex].tmax);
                    $("#bplah").text(planes[this.selectedIndex].h);
                    $("#bplar").text(planes[this.selectedIndex].r);
                    $("#bplatr").text(planes[this.selectedIndex].tr);
                    var c = '';
                    c = c + '<tr>';
                    c = c + '<td>Наименование</td>';
                    c = c + '<td>Ожидаемое время работы</td>';
                    c = c + '<td>Среднее время работы</td>';
                    c = c + '<td>P=0.25</td>';
                    c = c + '<td>P=0.5</td>';
                    c = c + '<td>P=0.75</td>';
                    c = c + '<td>P=0.99</td>';
                    c = c + '</tr>';
                    c = c + '<tr>';
                    c = c + '<td>' + planesp[this.selectedIndex].name + '</td>';
                    c = c + '<td>' + planesp[this.selectedIndex].to + '</td>';
                    c = c + '<td>' + planesp[this.selectedIndex].ts + '</td>';
                    c = c + '<td>' + planesp[this.selectedIndex].P1 + '</td>';
                    c = c + '<td>' + planesp[this.selectedIndex].P2 + '</td>';
                    c = c + '<td>' + planesp[this.selectedIndex].P3 + '</td>';
                    c = c + '<td>' + planesp[this.selectedIndex].P4 + '</td>';

                    c = c + '</tr>';
                    document.getElementById('ver').innerHTML = c;
                }

                if ($("#type").val() === 'Вертолет') {
                    console.log(this.selectedIndex);
                    $("#bplam").text(helicopters[this.selectedIndex].m);
                    $("#bplat").text(helicopters[this.selectedIndex].tmax);
                    $("#bplah").text(helicopters[this.selectedIndex].h);
                    $("#bplar").text(helicopters[this.selectedIndex].r);
                    $("#bplatr").text(helicopters[this.selectedIndex].tr);
                    var c = '';
                    c = c + '<tr>';
                    c = c + '<td>Наименование</td>';
                    c = c + '<td>Ожидаемое время работы</td>';
                    c = c + '<td>Среднее время работы</td>';
                    c = c + '<td>P=0.25</td>';
                    c = c + '<td>P=0.5</td>';
                    c = c + '<td>P=0.75</td>';
                    c = c + '<td>P=0.99</td>';
                    c = c + '</tr>';
                    c = c + '<tr>';
                    c = c + '<td>' + helicoptersp[this.selectedIndex].name + '</td>';
                    c = c + '<td>' + helicoptersp[this.selectedIndex].to + '</td>';
                    c = c + '<td>' + helicoptersp[this.selectedIndex].ts + '</td>';
                    c = c + '<td>' + helicoptersp[this.selectedIndex].P1 + '</td>';
                    c = c + '<td>' + helicoptersp[this.selectedIndex].P2 + '</td>';
                    c = c + '<td>' + helicoptersp[this.selectedIndex].P3 + '</td>';
                    c = c + '<td>' + helicoptersp[this.selectedIndex].P4 + '</td>';
                    c = c + '</tr>';
                    document.getElementById('ver').innerHTML = c;
                }
            });

            $("#nmarsh").change(function () {
                // var v = '';
                // v = v + '<tr>';
                // v = v + '<td>';
                // v = v + 'Маршрут '+ parseInt(this.selectedIndex)+1;
                // v = v + '</td>';

                // v = v + '</tr>';
                // document.getElementById('vmarsh').innerHTML = v;
            });

            function E() {
                var T1 = document.getElementById('t1').value;
                var T2 = document.getElementById('t2').value;
                var T3 = document.getElementById('t3').value;
                var T4 = document.getElementById('t4').value;
                var m = Math.ceil((parseInt(T1) + parseInt(T3) + parseInt(T4)) / parseInt(T2)) + 1;
                $("#nbpla").text(m);
            }
        </script>
        <script src="chart.js@2.8.0"></script>
</body>

</html>